function Kj= hexreinforce(t, Y)

% A = [ 0,           1, 0,          0, 0,           0, 0, 0, 0, 0, 0, 0
% ; 0,           0, 0, (62*Y(6))/75, 0,  (62*Y(4))/75, 0, 0, 0, 0, 0, 0
% ; 0,           0, 0,          1, 0,           0, 0, 0, 0, 0, 0, 0
% ; 0, -(62*Y(6))/75, 0,          0, 0, -(62*Y(2))/75, 0, 0, 0, 0, 0, 0
% ; 0,           0, 0,          0, 0,           1, 0, 0, 0, 0, 0, 0
% ; 0,           0, 0,          0, 0,           0, 0, 0, 0, 0, 0, 0
% ; 0,           0, 0,          0, 0,           0, 0, 1, 0, 0, 0, 0
% ; 0,           0, 0,          0, 0,           0, 0, 0, 0, 0, 0, 0
% ; 0,           0, 0,          0, 0,           0, 0, 0, 0, 1, 0, 0
% ; 0,           0, 0,          0, 0,           0, 0, 0, 0, 0, 0, 0
% ; 0,           0, 0,          0, 0,           0, 0, 0, 0, 0, 0, 1
% ; 0,           0, 0,          0, 0,           0, 0, 0, 0, 0, 0, 0];

A = [ 0     1     0     0     0     0     0     0     0     0     0     0
    ; 0     0     0     0     0     0     0     0     0     0     0     0
    ; 0     0     0     1     0     0     0     0     0     0     0     0
    ; 0     0     0     0     0     0     0     0     0     0     0     0
    ; 0     0     0     0     0     1     0     0     0     0     0     0
    ; 0     0     0     0     0     0     0     0     0     0     0     0
    ; 0     0     0     0     0     0     0     1     0     0     0     0
    ; 0     0     0     0     0     0     0     0     0     0     0     0
    ; 0     0     0     0     0     0     0     0     0     1     0     0
    ; 0     0     0     0     0     0     0     0     0     0     0     0
    ; 0     0     0     0     0     0     0     0     0     0     0     1
    ; 0     0     0     0     0     0     0     0     0     0     0     0];

B = [ 0         0         0         0
    ; 0   30.6667         0         0
    ; 0         0         0         0
    ; 0         0   30.6667         0
    ; 0         0         0         0
    ; 0         0         0  176.9231
    ; 0         0         0         0
    ; 0         0         0         0
    ; 0         0         0         0
    ; 0         0         0         0
    ; 0         0         0         0
    ; 1.5385         0         0         0];

T=50;
P=zeros(12,12,T);
Q=eye(12);
r=eye(4);
Kj=zeros(4,12);
P1=rand(12);
P(:,:,1)=P1;
for i=2:1:T

    P(:,:,i)=transpose(A-B*Kj)*P(:,:,i-1)*(A-B*Kj)+Q+transpose(Kj)*r*Kj;
end
Kj=pinv(r+transpose(B)*P(:,:,T)*B)*transpose(B)*P(:,:,T)*A;
P1=P(:,:,T);

end